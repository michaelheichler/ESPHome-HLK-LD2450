substitutions:
  name: esphome-web-208480
  friendly_name: mmwave-Presense-2450-Treppe
  wifi_ssid: !secret wifi_ssid
  wifi_password: !secret wifi_password
  illuminance_update_interval: 10s

esphome:
  name: ${name}
  friendly_name: ${friendly_name}
  min_version: 2024.6.0
  name_add_mac_suffix: false

esp32:
  board: esp32dev
  framework:
    type: esp-idf

wifi:
  ssid: ${wifi_ssid}
  password: ${wifi_password}

logger:

api:

ota:

improv_serial:

light:
- platform: status_led
  name: ESP32 LED
  pin: GPIO14
  internal: False
  restore_mode: ALWAYS_OFF

i2c:
- id: bus_a
  sda: 21
  scl: 22
  scan: true

external_components:
- source: github://TillFleisch/ESPHome-HLK-LD2450@main

uart:
  id: uart_bus
  rx_pin:
    number: GPIO16
    mode:
      input: true
      pullup: true
  tx_pin:
    number: GPIO17
    mode:
      input: true
      pullup: true
  baud_rate: 256000
  parity: NONE
  stop_bits: 1
  data_bits: 8

LD2450:
  uart_id: uart_bus
  flip_x_axis: true
  fast_off_detection: true
  max_detection_tilt_angle:
    name: "Max Tilt Angle"
    initial_value: 40°
  min_detection_tilt_angle:
    name: "Min Tilt Angle"
    initial_value: -40°
  max_detection_distance:
    name: "Max Distance"
    initial_value: 4m
  max_distance_margin: 30cm

  restart_button:
    name: "Restart Sensor"
  factory_reset_button:
    name: "Factory Reset Sensor"

  tracking_mode_switch:
    name: "Multiple Target Tracking"
  bluetooth_switch:
    name: "Sensor Bluetooth"

  baud_rate_select:
    name: "Sensor Baud Rate"

  zones:
  - zone:
      name: "Zone 1"
      polygon:
      - point:
          x: !lambda "return id(zone1_x1).state;"
          y: !lambda "return id(zone1_y1).state;"
      - point:
          x: !lambda "return id(zone1_x2).state;"
          y: !lambda "return id(zone1_y1).state;"
      - point:
          x: !lambda "return id(zone1_x2).state;"
          y: !lambda "return id(zone1_y2).state;"
      - point:
          x: !lambda "return id(zone1_x1).state;"
          y: !lambda "return id(zone1_y2).state;"
      occupancy:
        id: zone1_occupancy
        name: "Zone 1 Occupancy"
      target_count:
        id: zone1_target_count
        name: "Zone 1 Target Count"
  - zone:
      name: "Zone 2"
      polygon:
      - point:
          x: !lambda "return id(zone2_x1).state;"
          y: !lambda "return id(zone2_y1).state;"
      - point:
          x: !lambda "return id(zone2_x2).state;"
          y: !lambda "return id(zone2_y1).state;"
      - point:
          x: !lambda "return id(zone2_x2).state;"
          y: !lambda "return id(zone2_y2).state;"
      - point:
          x: !lambda "return id(zone2_x1).state;"
          y: !lambda "return id(zone2_y2).state;"
      occupancy:
        id: zone2_occupancy
        name: "Zone 2 Occupancy"
      target_count:
        id: zone2_target_count
        name: "Zone 2 Target Count"

number:
- platform: template
  name: "Zone 1 X1"
  id: zone1_x1
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 0
- platform: template
  name: "Zone 1 Y1"
  id: zone1_y1
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 0
- platform: template
  name: "Zone 1 X2"
  id: zone1_x2
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 2
- platform: template
  name: "Zone 1 Y2"
  id: zone1_y2
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 2
- platform: template
  name: "Zone 2 X1"
  id: zone2_x1
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 2
- platform: template
  name: "Zone 2 Y1"
  id: zone2_y1
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 0
- platform: template
  name: "Zone 2 X2"
  id: zone2_x2
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 4
- platform: template
  name: "Zone 2 Y2"
  id: zone2_y2
  unit_of_measurement: "m"
  min_value: 0
  max_value: 10
  step: 0.1
  optimistic: true
  restore_value: true
  initial_value: 2
